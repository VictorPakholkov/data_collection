# Модуль 3. Практическое занятие. Мультимодальные данные

*Ноутбук с выполнененным заданием находится в этой директории под названием 'Multimodal_data.ipynb'*

На занятии номер 6 я был с командой участников, занимавшейся "Кейсом в сфере обработки естественного языка: Разметка текстов для анализа тональности".
На занятии, нам посоветовали обратить внимание на возможную мультимодальность этой задачи и как мультимодальные данные могут использоваться для получения контекста, определения иронии и улучшения выполнения поставленной задачи.

В данном домашнем задании я попытаюсь использовать мультимодальные данные для иллюстрации возможных кейсов их использования в задаче разметки текстов для анализа тональности отзывов.

## Данные

Для выполнения данной задачи я взял датасет, предоставленный University of California, San Diego от группы исследователей Mcauley Group.

Датасет доступен по следующей ссылке (image_review_all.json): https://datarepo.eng.ucsd.edu/mcauley_group/gdrive/googlelocal_restaurants/

Мультимодальные данные от mcauley_group посвящены отзывам на рестораны и состоят из двух частей: текста отзыва и приложенной картинки.

Текст отзыва представляет собой произвольный текст, написанный пользователем о своем опыте посещения ресторана. Текст может содержать информацию о качестве еды, уровне обслуживания, атмосфере и других аспектах ресторана.

Картинка представляет собой изображение, которое пользователь может прикрепить к своему отзыву. Изображение может быть фотографией еды, интерьера ресторана или чего-то еще, связанного с отзывом. Возможно прикрепить несколько картинок к одному отзыву (как люди обычно и делают на самом деле, редко ограничиваясь только одной фотографией).

Датасет содержит аж почти 1500000 отзывов на рестораны из США (я использовал первые тысячу для демонстрационных целей). Для каждого отзыва в датасете доступны следующие поля:

- business_id: идентификатор ресторана, о котором написан отзыв
- user_id: идентификатор пользователя, написавшего отзыв
- rating: рейтинг ресторана, присвоенный пользователем (от 1 до 5)
- review_text: текст отзыва

Для каждой картинки доступны два идентефикатора: id и url, где id - это финальная часть url после послденего слэша.

После загрузки первых 1000 строчек json-файла, его пришлось распарсить, из-за необычной структуры датасета.
Ссылки на картинки и их id для каждого отзыва были объединены в соответсвующие колонки, где сконкатенированы через ',' для более наглядного визуального представления и удобства дальнейшей работы.


## Связка мультимодальных данных для потенциальной разметки

Таким образом, в датасете имеются текстовые данные и ссылки на данные-изображения:

![image](https://github.com/VictorPakholkov/data_collection/assets/56613496/ffc24466-b336-429a-a4b1-ae1059fee3fd)
Fig 1. Структура данных

Далее, изображения были скачаны в отдельную папку 'images' с помощью предоставленных в изначальных данных urls. 
Тем не менее, видимо за возрастом датасета, некоторые изображения получить не удалось.
Датасет был отфильтрован, оставлены только те строчки, изображения для которых доступны до сих пор.

После этого, для была создана отдельная колонка, в которой хранятся пути к получившимся изображениям.


## Предварительная обработка данных

Текстовые данные были предобработаны с помощью библиотек pymorphy2 и nltk. 

В начале был произведен импорт необходимых модулей, таких как nltk для работы с естественным языком и pymorphy2 для лемматизации. Затем были загружены стоп-слова на русском языке из библиотеки nltk.

Основная часть кода - это определение функции process_text_russian, предназначенной для предобработки текста. В этой функции текст разделяется на токены (слова), из которых удаляются стоп-слова. Далее каждое слово лемматизируется с использованием pymorphy2. В конечном итоге функция возвращает предобработанный текст в виде строки.

Наконец, предобработка применяется к столбцу 'review_text' в моих данных. Каждая ячейка этого столбца подвергается обработке с использованием ранее определенной функции. Это необходимо для подготовки текстовых данных к дальнейшему анализу или обучению моделей машинного обучения, так как он включает в себя шаги удаления лишних слов, структурирования текста и сведения слов к их базовым формам.

Изображения были предобработаны с помощью OpenCV.

В начале был указан путь к папке, содержащей изображения. Затем с помощью цикла была произведена итерация по файлам в этой папке, при условии, что файлы являются изображениями формата JPG. Для каждого изображения была применена загрузка с использованием OpenCV.

Далее была осуществлена нормализация значений пикселей изображения, приводя их к диапазону от 0 до 1. Этот процесс важен при подготовке данных для обучения моделей машинного обучения, поскольку многие алгоритмы ожидают входные данные в определенном стандартном формате. Нормализованные изображения были сохранены обратно в тех же файлах, что исходные, с учетом изменений. Таким образом, данный код используется для обработки изображений и помогает для подготовки их к последующему использованию в задачах машинного обучения.


## EDA

Обзорный анализ данных был произведен для картинок и текста.

Для картинок был проведен анализ распределения размерности, для того, чтобы удостовериться в результатах предобработки.
![image](https://github.com/VictorPakholkov/data_collection/assets/56613496/8dbc2533-3414-45e2-8015-d1d55cd3a7ab)

Кроме того, был проведен анализ pixel intensity, для определения возможных необходимых дополнительных шгов нормализации изображений.
![image](https://github.com/VictorPakholkov/data_collection/assets/56613496/8076b5cc-a781-4d10-acd8-7e5481b96272)

Для текстовых данных был произведен анализ наиболее частотных слов, а также анализ длинн текстовых ревью.
![image](https://github.com/VictorPakholkov/data_collection/assets/56613496/7266a4ef-8cff-4c5a-9e38-fad5a8ff2715)

![image](https://github.com/VictorPakholkov/data_collection/assets/56613496/1aa0919b-10ad-48d5-a896-7c0fedc17ca3)



## Последующие возможные варинты связки мультимодальных данных:

Дальнейшие возможные сценарии более глубокой связки мультимодальных данных я вижу так:

- Текстовая обработка: преобразование текстовых отзывов в числовое представление: можно использовать методы векторизации текста, такие как TF-IDF (Term Frequency-Inverse Document Frequency) или Word Embeddings (например, Word2Vec, GloVe) для преобразования текстовых данных в числовой формат.

- Обработка изображений: можно использовать пре-трэйнд модели для извлечения признаков из изображений, например, с использованием CNN. Популярные модели в этой области включают VGG, ResNet, или EfficientNet.

- Объединение представлений: после получения числовых представлений для текста и изображений, можно объединить их в одну общую представляющую структуру. Это можно сделать с помощью конкатенации векторов.

- Моделирование: в дальнейшем можно использовать мультимодальные модели. Для обработки объединенных представлений можно применить мультимодальные архитектуры, такие как Neural Tensor Networks (NTN), Concatenated Fusion, или другие модели, которые специально разработаны для работы с несколькими видами данных.


## Возможные кейсы использования полученного датасета 

Вот несколько примеров того, как можно использовать получившиеся мультимодальные данные для анализа отзывов на рестораны:

- Сравнение отзывов с изображениями: можно использовать машинное обучение для выявления закономерностей между текстом отзыва и изображением. Например, можно обнаружить, что отзывы с положительными оценками чаще сопровождаются фотографиями еды.
  
- Извлечение информации из изображений: можно использовать компьютерное зрение для извлечения информации из изображений, например, для определения типа блюда или интерьера ресторана. Эту информацию можно использовать для улучшения анализа отзывов.
  
- Поиск похожих отзывов: можно использовать сходство между текстом и изображениями для поиска похожих отзывов. Это может быть полезно, например, для создания рекомендаций по ресторанам.

Один из иных кейсов использования - объединение текстовой и визуальной информации. Модель, способная эффективно интегрировать данные из отзывов и изображений, может значительно повысить точность определения настроений, учитывая более широкий контекст отзыва. (например 1 звезда, написано все супер, а в фотографии приложено блюдо из несвежих продуктов или муха в супе).

Дополнительно, мультимодальный подход может быть применен для оценки атмосферы и визуальных аспектов ресторанов. Анализируя визуальные аспекты, такие как интерьер, блюда и обслуживание, в сочетании с текстовыми отзывами, можно получить более полное представление о восприятии клиентами ресторана. Другим возможным кейсом использования является предсказание успешности ресторана. Мультимодальный анализ, учитывая как текстовые, так и визуальные компоненты, может помочь в создании модели, способной предсказывать успех бизнеса. Это может быть ценным инструментом для бизнес-аналитики и принятия решений ресторанными сетями. Кроме того, использование таких вот мультимодальных данных может улучшить персонализированные рекомендации. Создание более точных рекомендаций, учитывая предпочтения пользователей и визуальные впечатления от ресторанов, может значительно улучшить бизнес метрики и быть полезным предпринимателям в этой сфере.

**Мультимодальные данные представляют собой ценный ресурс для анализа отзывов на рестораны. Они позволяют получить более полное представление о пользовательском опыте и использовать различные методы анализа для получения более точных результатов.**


